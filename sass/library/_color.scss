$colors               : ()        !default;
$color-default-scheme : 'default' !default;

// color($key, [$scheme])
//
// Returns a color value given a key word and optional color scheme. If the
// named color is not in the given color scheme, the "default" color scheme will
// be searched.
//
// Usage:
// ```scss
// .ex {
//   background-color: color(body-bg);
//   border: 1px solid color(border, 'grace');
// }
// ```
//
// $key     - The name of the requested color.
// $scheme  - Optional color scheme to choose from; defaults to `$color-default-scheme`.
//
// Style guide: sass.functions.color
@function color($key, $scheme: $color-default-scheme) {
  @if map-has-key($colors, $scheme) and map-has-key(map-get($colors, $scheme), 'names') and map-has-key(map-get(map-get($colors, $scheme), 'names'), $key) {
    @return map-get(map-get(map-get($colors, $scheme), 'names'), $key);
  } @else if map-has-key(map-get(map-get($colors, 'default'), 'names'), $key) {
    @return map-get(map-get(map-get($colors, 'default'), 'names'), $key);
  } @else {
    @error 'The color "#{$key}" was not found in $colors map.';
  }
}

// add-color-scheme($scheme, $description, $new-colors)
//
// Sets the colors for a new color scheme.
//
// Usage:
// ```scss
// $colors: add-color-scheme('design', 'Colors used by different parts of the design.', (
//  link:             color(blue),
//  link-visited:     color(blue-dark),
//  link-focus:       color(red),
// ));
// ```
//
// $scheme      - The name of the new color scheme.
// $description - A description of the color scheme.
// $new-colors  - A Sass map containing the new colors.
//
// Style guide: sass.functions.color.add-color-scheme
@function add-color-scheme($scheme, $description, $new-colors) {
  $colors: map-merge($colors, ($scheme: ('description': $description, 'names': $new-colors)));
  @return $colors;
}

// add-default-color-scheme($description, $new-colors)
//
// Sets the default scheme.
//
// Usage:
// ```scss
// $colors: add-default-color-scheme('The main colors of the site.', (
//   white:            #fff,
//   grey-dark:        #545d5d,
//   blue:             #008fbf,
// ));
// ```
//
// $description - A description of the default color scheme.
// $new-colors  - A Sass map containing the new colors.
//
// Style guide: sass.functions.color.add-default-color-scheme
@function add-default-color-scheme($description, $new-colors) {
  @return add-color-scheme('default', $description, $new-colors);
}

// kss-color-markup()
//
// Returns the HTML needed to display all colors in color() in a KSS style
// guide. The parameters are used to specifiy the classes for various elements.
//
// $wrapper-class     - Defaults to 'kss-text'.
// $title-class       - Defaults to 'kss-color__title'.
// $description-class - Defaults to 'kss-color__description'.
// $color-class       - Defaults to 'kss-color'.
// $swatch-class      - Defaults to 'kss-color__swatch'.
// $variable-class    - Defaults to 'kss-color__variable'.
//
// style guide: sass.functions.color.kss-color-markup

@function kss-color-markup($wrapper-class: 'kss-style', $title-class: 'kss-color__title', $description-class: 'kss-color__description', $color-class: 'kss-color', $swatch-class: 'kss-color__swatch', $variable-class: 'kss-color__variable') {
  $markup: '';

  @if $wrapper-class {
    $markup: '<div class="' + $wrapper-class + '">';
  }

  @each $scheme, $map in $colors {
    // Display the scheme name and description.
    $markup: $markup + '<h3 class="' + $title-class + '">#{$scheme}</h3><p class="' + $description-class + '">#{map-get($map, 'description')}</p>';

    // Display the colors in the scheme.
    @each $color, $value in map-get($map, 'names') {
      $markup: $markup + '<div class="' + $color-class + '"><span class="' + $swatch-class + '" style="background-color: #{$value}"></span><code class="' + $variable-class + '">color(#{$color})</code></div>';
    }
  }

  @if $wrapper-class {
    $markup: $markup + '</div>';
  }
  @return $markup;
}
